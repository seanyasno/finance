---
phase: 09-visual-formatting-and-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/finance/finance/Generated/CustomModels.swift
  - apps/finance/finance/Generated/ModelExtensions.swift
  - apps/finance/finance/Views/Components/CardLabel.swift
autonomous: true

must_haves:
  truths:
    - "Card displays show format 'CardName 1234' with space separator"
    - "Last 4 digits render in monospace font for visual distinction"
    - "CardLabel view is reusable across all card display contexts"
  artifacts:
    - path: "apps/finance/finance/Views/Components/CardLabel.swift"
      provides: "Reusable card display component"
      min_lines: 20
    - path: "apps/finance/finance/Generated/ModelExtensions.swift"
      provides: "Updated displayName and cardSectionHeader without asterisks"
      contains: "last4Digits"
  key_links:
    - from: "CardLabel.swift"
      to: "CreditCard/TransactionCreditCard"
      via: "company and cardNumber properties"
      pattern: "cardNumber\\.suffix\\(4\\)"
---

<objective>
Create reusable CardLabel component and update card formatting infrastructure to use "CardName 1234" format with monospace digits.

Purpose: Provide consistent, clean card display across all views with visual distinction for the last 4 digits.
Output: CardLabel SwiftUI view component and updated model extensions.

Note: Per 09-CONTEXT.md user decision, format uses "spaces only, no bullets or dashes" - this supersedes any prior FORMAT-06 requirement specifying bullet characters.
</objective>

<execution_context>
@/Users/seanyasno/.claude/get-shit-done/workflows/execute-plan.md
@/Users/seanyasno/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-visual-formatting-&-polish/09-CONTEXT.md
@apps/finance/finance/Generated/CustomModels.swift
@apps/finance/finance/Generated/ModelExtensions.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CardLabel SwiftUI component</name>
  <files>apps/finance/finance/Views/Components/CardLabel.swift</files>
  <action>
Create a new CardLabel SwiftUI view in a new Components folder:

1. Create file at `apps/finance/finance/Views/Components/CardLabel.swift`
2. CardLabel should accept:
   - `companyName: String` - The card company name (e.g., "Max", "Isracard")
   - `last4Digits: String` - The last 4 digits of the card number
3. Render as HStack with:
   - Company name in regular font
   - Space separator (just whitespace, no bullets or dashes)
   - Last 4 digits in `.monospaced()` font modifier for visual distinction
4. Use `.font(.caption)` and `.foregroundColor(.secondary)` as defaults, but allow customization via view modifiers
5. Add convenience initializers:
   - `init(card: CreditCard)` - Extract company and last 4 from CreditCard
   - `init(card: TransactionCreditCard)` - Extract company and last 4 from TransactionCreditCard
6. Include SwiftUI Preview with sample data

The format should be clean: "Max 1234" (not "Max ****1234" or "Max ••1234")
  </action>
  <verify>File exists and contains CardLabel struct with HStack, monospaced modifier, and both convenience initializers</verify>
  <done>CardLabel.swift exists with reusable component rendering "CompanyName 1234" format with monospace digits</done>
</task>

<task type="auto">
  <name>Task 2: Update model extensions for new card format</name>
  <files>apps/finance/finance/Generated/ModelExtensions.swift</files>
  <action>
Update CreditCard and Transaction extensions to use new card format:

1. Add `last4Digits` computed property to CreditCard extension:
   ```swift
   var last4Digits: String {
       String(cardNumber.suffix(4))
   }
   ```

2. Update CreditCard `displayName` to use new format (no asterisks):
   ```swift
   var displayName: String {
       "\(company.rawValue) \(last4Digits)"
   }
   ```

3. Add `last4Digits` computed property to TransactionCreditCard (if not already extended):
   ```swift
   extension TransactionCreditCard {
       var last4Digits: String {
           String(cardNumber.suffix(4))
       }
   }
   ```

4. Update Transaction `cardSectionHeader` to use new format:
   ```swift
   var cardSectionHeader: String {
       if let card = creditCard {
           return "\(card.company.rawValue) \(String(card.cardNumber.suffix(4)))"
       }
       return "Unknown Card"
   }
   ```

These changes ensure all existing uses of displayName and cardSectionHeader automatically get the new format.
  </action>
  <verify>Build iOS app to confirm no compiler errors; verify displayName and cardSectionHeader produce "CompanyName 1234" format</verify>
  <done>Model extensions updated with last4Digits properties and new display format without asterisks</done>
</task>

<task type="auto">
  <name>Task 3: Add isPending property to Transaction extension</name>
  <files>apps/finance/finance/Generated/ModelExtensions.swift</files>
  <action>
Add a convenience property for checking pending status (will be used in Plan 02):

1. Add to Transaction extension:
   ```swift
   var isPending: Bool {
       status == .pending
   }
   ```

This provides a clean API for UI code to check pending status.
  </action>
  <verify>Build iOS app to confirm isPending compiles correctly</verify>
  <done>Transaction.isPending property exists and returns true when status is .pending</done>
</task>

</tasks>

<verification>
1. `xcodebuild -workspace apps/finance/finance.xcworkspace -scheme finance -destination 'platform=iOS Simulator,name=iPhone 15' build` succeeds
2. CardLabel.swift exists in Views/Components/
3. ModelExtensions.swift contains:
   - `last4Digits` on both CreditCard and TransactionCreditCard
   - Updated `displayName` without asterisks
   - Updated `cardSectionHeader` without asterisks
   - `isPending` property on Transaction
</verification>

<success_criteria>
- CardLabel component created and buildable
- All card displays use "CardName 1234" format (no asterisks, no bullets)
- Last 4 digits use monospace font for visual distinction
- isPending property available for Plan 02
- iOS app builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/09-visual-formatting-&-polish/09-01-SUMMARY.md`
</output>
